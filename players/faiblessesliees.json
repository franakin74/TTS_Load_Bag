{"GUID":"af8df1","Name":"Custom_Model_Bag","Transform":{"posX":89,"posY":1.05000138,"posZ":-6.500004,"rotX":-0.00000495795939,"rotY":179.999741,"rotZ":2.31540113e-7,"scaleX":0.700000465,"scaleY":0.700000465,"scaleZ":0.700000465},"Nickname":"Faiblesses liées","Description":"","GMNotes":"{\"bondedWeakness\":\"true\"}","AltLookAngle":{"x":0,"y":0,"z":0},"ColorDiffuse":{"r":0.8623694,"g":0.70207715,"b":0},"LayoutGroupSortIndex":0,"Value":0,"Locked":false,"Grid":true,"Snap":true,"IgnoreFoW":false,"MeasureMovement":false,"DragSelectable":true,"Autoraise":true,"Sticky":true,"Tooltip":true,"GridProjection":false,"HideWhenFaceDown":false,"Hands":false,"MaterialIndex":-1,"MeshIndex":-1,"CustomMesh":{"MeshURL":"https://pastebin.com/raw/ALrYhQGb","DiffuseURL":"http://cloud-3.steamusercontent.com/ugc/1984428656373776775/C770687449D179BF39AA9F1808F749A5593C7157/","NormalURL":"","ColliderURL":"","Convex":true,"MaterialIndex":3,"TypeIndex":6,"CustomShader":{"SpecularColor":{"r":1,"g":1,"b":1},"SpecularIntensity":0,"SpecularSharpness":2,"FresnelStrength":0},"CastShadows":true},"Bag":{"Order":0},"LuaScript":"packupZone =\r\n'4708b1'        -- change this to the GUID of your own script packupZone-- set the object you sant the script to be affected with, all other objects will be ignored\r\nadditive = true -- This will disable the save system, allowing you to setup a bag, and then next time you pack up it will only pick up what it already has saved before.\r\n-- UseBagNameAsButtonName = false\r\n\r\n--Runs whenever game is saved/autosaved\r\nfunction onSave()\r\n    --Begin State Managment of Saving Object Data.\r\n    --Create GUID list fomr Object List\r\n    if tableSize(memoryData) == 0 then\r\n        saved_data = \"\"\r\n        return saved_data\r\n    else\r\n        local data_to_save = { md = memoryData }\r\n        saved_data = JSON.encode(data_to_save)\r\n        -- saved_data = \"\" --Remove -- at start + save to clear save data\r\n        return saved_data\r\n    end\r\nend\r\n\r\nfunction onload(saved_data)\r\n    if saved_data ~= \"\" then\r\n        local loaded_data = JSON.decode(saved_data)\r\n        --Set up information off of loaded_data\r\n        memoryData = loaded_data.md\r\n    else\r\n        --Set up information for if there is no saved saved data\r\n        memoryData = {}\r\n    end\r\n    -- SetButtonName()\r\n    makeButtons()\r\n    metadatabag = getMetabag()\r\nend\r\n\r\nfunction getMetabag()\r\n    local metadatabag\r\n    local GM_Note = self.getGMNotes()\r\n    if GM_Note ~= '' then\r\n        local bagtmpmetadata = JSON.decode(GM_Note)\r\n        if type(bagtmpmetadata) == \"table\" then\r\n            metadatabag = bagtmpmetadata\r\n        end\r\n    end\r\n    return metadatabag\r\nend\r\n\r\n-- function SetButtonName()\r\n--     if UseBagNameAsButtonName then\r\n--         PlaceText = self.getName()\r\n--         PlaceWidth = string.len(PlaceText) * 145\r\n--         PlaceHeight = 450\r\n--         Scale = { 3.2, 3.2, 3.2 }\r\n--     else\r\n--         PlaceText = 'Placer'\r\n--         PlaceWidth = 900\r\n--         PlaceHeight = 400\r\n--         Scale = { 0.9, 0.9, 0.9 }\r\n--     end\r\n--     self.clearButtons()\r\n--     makeButtons()\r\n-- end\r\n\r\nfunction createSaveData(obj)\r\n    local objData = {\r\n        position = tableCullNumericIndexes(obj.getPosition()),\r\n        rotation = tableCullNumericIndexes(obj.getRotation()),\r\n        guid = obj.getGUID(),\r\n        lock = obj.getLock(),\r\n        interactable = tostring(obj.interactable),\r\n        tooltip = tostring(obj.tooltip)\r\n    }\r\n\r\n    memoryData[objData.guid] = objData\r\nend\r\n\r\nfunction placeStuff()\r\n    local prams = {}\r\n    for key, entry in pairs(memoryData) do\r\n        prams.guid = key\r\n        prams.position = { entry.position.x, entry.position.y, entry.position.z }\r\n        prams.rotation = { entry.rotation.x, entry.rotation.y, entry.rotation.z }\r\n        local item = self.takeObject(prams)\r\n\r\n        if entry.lock == true then\r\n            item.setPositionSmooth({ entry.position.x, entry.position.y, entry.position.z }, false, true)\r\n            item.setRotationSmooth({ entry.rotation.x, entry.rotation.y, entry.rotation.z }, false, true)\r\n            item.setLock(entry.lock)\r\n        end\r\n\r\n        if entry.tooltip == 'false' then item.tooltip = false end\r\n        if entry.interactable == 'false' then item.interactable = false end\r\n    end\r\n    if additive == true then memoryData = {} end\r\n    -- SetButtonName()\r\nend\r\n\r\nfunction pickupStuff()\r\n    if metadatabag ~= nil then\r\n        if additive == true then\r\n            -- Grab All Objects in Zone\r\n            for _, obj in ipairs(getObjectFromGUID(packupZone).getObjects()) do\r\n                local add = false\r\n                if obj ~= self then\r\n                    local GNote = { gm_notes = obj.getGMNotes() }\r\n                    if Global.call('checkIfMetadata', GNote) then\r\n                        local cardmetadata = JSON.decode(GNote.gm_notes)\r\n                        if metadatabag.cycle ~= nil then\r\n                            if metadatabag.cycle == cardmetadata.cycle then\r\n                                add = true\r\n                            end\r\n                        elseif metadatabag.class ~= nil then\r\n                            if checkClass(metadatabag, cardmetadata) and checkXP(metadatabag, cardmetadata) then\r\n                                add = true\r\n                            end\r\n                        elseif metadatabag.type ~= nil then\r\n                            if metadatabag.type == cardmetadata.type then\r\n                                add = true\r\n                            end\r\n                        elseif metadatabag.bondcard ~= nil then\r\n                            if metadatabag.bondcard == cardmetadata.bondcard then\r\n                                add = true\r\n                            end\r\n                        elseif metadatabag.bondedWeakness ~= nil then\r\n                            if metadatabag.bondedWeakness == cardmetadata.bondedWeakness then\r\n                                add = true\r\n                            end\r\n                        end\r\n                    end\r\n                end\r\n                if add == true then\r\n                    createSaveData(obj)\r\n                    self.putObject(obj)\r\n                end\r\n                add = true\r\n            end\r\n        end\r\n\r\n        if additive == false then\r\n            for key, entry in pairs(memoryData) do\r\n                self.putObject(getObjectFromGUID(key))\r\n            end\r\n        end\r\n        -- SetButtonName()\r\n    end\r\nend\r\n\r\nfunction tableSize(t)\r\n    local count = 0\r\n    for key, value in pairs(t) do count = count + 1 end\r\n    return count\r\nend\r\n\r\nfunction tableCullNumericIndexes(t)\r\n    for i, v in pairs(t) do\r\n        if type(i) == \"number\" then\r\n            table.remove(t, i)\r\n            return tableCullNumericIndexes(t)\r\n        end\r\n    end\r\n    return t\r\nend\r\n\r\nfunction makeButtons()\r\n    -- DEFAULT START BUTTONS\r\n    -- if set == nil then\r\n    local button_Place = {\r\n        click_function = 'placeStuff',\r\n        function_owner = self,\r\n        label = 'Placer',\r\n        position = { 0, 0.1, 1.8 },\r\n        rotation = { 0, 0, 0 },\r\n        width = 1000,\r\n        height = 400,\r\n        font_size = 250,\r\n        scale = { 0.9, 0.9, 0.9 },\r\n        color = { 0, 0, 0 },\r\n        font_color = { 1, 1, 1 }\r\n    }\r\n    self.createButton(button_Place)\r\n\r\n    local button_PickUp = {\r\n        click_function = 'pickupStuff',\r\n        function_owner = self,\r\n        label = 'Ranger',\r\n        position = { 1.8, 0.1, 0 },\r\n        rotation = { 0, -90, 0 },\r\n        width = 1000,\r\n        height = 400,\r\n        font_size = 250,\r\n        scale = { 0.9, 0.9, 0.9 },\r\n        color = { 0, 0, 0 },\r\n        font_color = { 1, 1, 1 }\r\n    }\r\n\r\n    self.createButton(button_PickUp)\r\nend\r\n\r\nfunction checkXP(bag, card)\r\n    if (bag.experience == false and card.level == 0) or (bag.experience == true and card.level > 0) then\r\n        return true\r\n    else\r\n        return false\r\n    end\r\nend\r\n\r\nfunction checkClass(bag, card)\r\n    if string.find(card.class, bag.class) ~= nil then\r\n        return true\r\n    else\r\n        return false\r\n    end\r\nend\r\n","LuaScriptState":"{\"md\":{\"049149\":{\"guid\":\"049149\",\"interactable\":\"true\",\"lock\":false,\"position\":{\"x\":94.0000381469727,\"y\":0.993606388568878,\"z\":-9.49996852874756},\"rotation\":{\"x\":-5.22141772307805E-06,\"y\":180.000671386719,\"z\":8.27195890451549E-07},\"tooltip\":\"true\"},\"082c50\":{\"guid\":\"082c50\",\"interactable\":\"true\",\"lock\":false,\"position\":{\"x\":91.5,\"y\":0.993606746196747,\"z\":-13.0000410079956},\"rotation\":{\"x\":-4.97451446790365E-06,\"y\":179.999298095703,\"z\":8.08906122529152E-07},\"tooltip\":\"true\"},\"2214bb\":{\"guid\":\"2214bb\",\"interactable\":\"true\",\"lock\":false,\"position\":{\"x\":91.5000457763672,\"y\":0.993606448173523,\"z\":-9.4999532699585},\"rotation\":{\"x\":-4.74813714390621E-06,\"y\":179.998992919922,\"z\":2.25186909119657E-07},\"tooltip\":\"true\"},\"a188ab\":{\"guid\":\"a188ab\",\"interactable\":\"true\",\"lock\":false,\"position\":{\"x\":96.5000228881836,\"y\":0.993606388568878,\"z\":-9.49998760223389},\"rotation\":{\"x\":-5.44485192222055E-06,\"y\":179.998428344727,\"z\":8.4895236796001E-07},\"tooltip\":\"true\"},\"ecfb64\":{\"guid\":\"ecfb64\",\"interactable\":\"true\",\"lock\":false,\"position\":{\"x\":94.0000381469727,\"y\":0.993606686592102,\"z\":-12.9999532699585},\"rotation\":{\"x\":-4.77603089166223E-06,\"y\":179.999847412109,\"z\":3.7503349403778E-07},\"tooltip\":\"true\"}}}","XmlUI":"","ContainedObjects":[{"GUID":"a188ab","Name":"Card","Transform":{"posX":96.50002,"posY":0.9936064,"posZ":-9.499988,"rotX":-0.000005444852,"rotY":179.998428,"rotZ":8.48952368e-7,"scaleX":1,"scaleY":1,"scaleZ":1},"Nickname":"Le Prix de l'Echec","Description":"","GMNotes":"{\n  \"bondedWeakness\": \"true\",\n  \"class\": \"Neutral\",\n  \"cycle\": \"The Forgotten Age\",\n  \"id\": \"04039\",\n  \"traits\": \"Pact.\",\n  \"type\": \"Treachery\",\n  \"weakness\": \"true\"\n}","AltLookAngle":{"x":0,"y":0,"z":0},"ColorDiffuse":{"r":0.713235259,"g":0.713235259,"b":0.713235259},"LayoutGroupSortIndex":0,"Value":0,"Locked":false,"Grid":true,"Snap":true,"IgnoreFoW":false,"MeasureMovement":false,"DragSelectable":true,"Autoraise":true,"Sticky":true,"Tooltip":true,"GridProjection":false,"HideWhenFaceDown":true,"Hands":true,"CardID":124025,"SidewaysCard":false,"CustomDeck":{"1240":{"FaceURL":"https://i.imgur.com/XmeYP0P.jpg","BackURL":"http://cloud-3.steamusercontent.com/ugc/931552806915249927/583EE2570FC1A094D59B991E97AB542CA94BEBC9/","NumWidth":10,"NumHeight":7,"BackIsHidden":true,"UniqueBack":false,"Type":0}},"LuaScript":"","LuaScriptState":"","XmlUI":""},{"GUID":"2214bb","Name":"Card","Transform":{"posX":91.5000458,"posY":0.993606448,"posZ":-9.499953,"rotX":-0.000004748137,"rotY":179.999,"rotZ":2.25186909e-7,"scaleX":1,"scaleY":1,"scaleZ":1},"Nickname":"Destin Inéluctable","Description":"","GMNotes":"{\n  \"bondedWeakness\": \"true\",\n  \"class\": \"Neutral\",\n  \"cycle\": \"The Forgotten Age\",\n  \"id\": \"04041\",\n  \"traits\": \"Curse.\",\n  \"type\": \"Treachery\",\n  \"weakness\": \"true\"\n}","AltLookAngle":{"x":0,"y":0,"z":0},"ColorDiffuse":{"r":0.713235259,"g":0.713235259,"b":0.713235259},"LayoutGroupSortIndex":0,"Value":0,"Locked":false,"Grid":true,"Snap":true,"IgnoreFoW":false,"MeasureMovement":false,"DragSelectable":true,"Autoraise":true,"Sticky":true,"Tooltip":true,"GridProjection":false,"HideWhenFaceDown":true,"Hands":true,"CardID":124023,"SidewaysCard":false,"CustomDeck":{"1240":{"FaceURL":"https://i.imgur.com/XmeYP0P.jpg","BackURL":"http://cloud-3.steamusercontent.com/ugc/931552806915249927/583EE2570FC1A094D59B991E97AB542CA94BEBC9/","NumWidth":10,"NumHeight":7,"BackIsHidden":true,"UniqueBack":false,"Type":0}},"LuaScript":"","LuaScriptState":"","XmlUI":""},{"GUID":"049149","Name":"Card","Transform":{"posX":94.00004,"posY":0.9936064,"posZ":-9.499969,"rotX":-0.00000522141772,"rotY":180.000671,"rotZ":8.271959e-7,"scaleX":1,"scaleY":1,"scaleZ":1},"Nickname":"Le Glas Sonne","Description":"","GMNotes":"{\n  \"bondedWeakness\": \"true\",\n  \"class\": \"Neutral\",\n  \"cycle\": \"The Forgotten Age\",\n  \"id\": \"04042\",\n  \"traits\": \"Curse.\",\n  \"type\": \"Treachery\",\n  \"weakness\": \"true\"\n}","AltLookAngle":{"x":0,"y":0,"z":0},"ColorDiffuse":{"r":0.713235259,"g":0.713235259,"b":0.713235259},"LayoutGroupSortIndex":0,"Value":0,"Locked":false,"Grid":true,"Snap":true,"IgnoreFoW":false,"MeasureMovement":false,"DragSelectable":true,"Autoraise":true,"Sticky":true,"Tooltip":true,"GridProjection":false,"HideWhenFaceDown":true,"Hands":true,"CardID":124024,"SidewaysCard":false,"CustomDeck":{"1240":{"FaceURL":"https://i.imgur.com/XmeYP0P.jpg","BackURL":"http://cloud-3.steamusercontent.com/ugc/931552806915249927/583EE2570FC1A094D59B991E97AB542CA94BEBC9/","NumWidth":10,"NumHeight":7,"BackIsHidden":true,"UniqueBack":false,"Type":0}},"LuaScript":"","LuaScriptState":"","XmlUI":""},{"GUID":"082c50","Name":"Card","Transform":{"posX":91.5,"posY":0.993606746,"posZ":-13.000041,"rotX":-0.00000497451447,"rotY":179.9993,"rotZ":8.089061e-7,"scaleX":1,"scaleY":1,"scaleZ":1},"Nickname":"Clauses en Petits Caractères","Description":"","GMNotes":"{\n  \"bondedWeakness\": \"true\",\n  \"class\": \"Neutral\",\n  \"cycle\": \"Return to the Forgotten Age\",\n  \"id\": \"53014\",\n  \"traits\": \"Pact.\",\n  \"type\": \"Treachery\",\n  \"weakness\": \"true\"\n}","AltLookAngle":{"x":0,"y":0,"z":0},"ColorDiffuse":{"r":0.713235259,"g":0.713235259,"b":0.713235259},"LayoutGroupSortIndex":0,"Value":0,"Locked":false,"Grid":true,"Snap":true,"IgnoreFoW":false,"MeasureMovement":false,"DragSelectable":true,"Autoraise":true,"Sticky":true,"Tooltip":true,"GridProjection":false,"HideWhenFaceDown":true,"Hands":true,"CardID":279414,"SidewaysCard":false,"CustomDeck":{"2794":{"FaceURL":"https://i.imgur.com/uUbvwIp.jpg","BackURL":"http://cloud-3.steamusercontent.com/ugc/931552806915249927/583EE2570FC1A094D59B991E97AB542CA94BEBC9/","NumWidth":10,"NumHeight":7,"BackIsHidden":true,"UniqueBack":false,"Type":0}},"LuaScript":"","LuaScriptState":"","XmlUI":""},{"GUID":"ecfb64","Name":"Card","Transform":{"posX":94.00004,"posY":0.9936067,"posZ":-12.9999533,"rotX":-0.000004776031,"rotY":179.999847,"rotZ":3.750335e-7,"scaleX":1,"scaleY":1,"scaleZ":1},"Nickname":"Vendre Votre Âme","Description":"","GMNotes":"{\n  \"bondedWeakness\": \"true\",\n  \"class\": \"Neutral\",\n  \"cycle\": \"Return to the Forgotten Age\",\n  \"id\": \"53015\",\n  \"traits\": \"Pact.\",\n  \"type\": \"Treachery\",\n  \"weakness\": \"true\"\n}","AltLookAngle":{"x":0,"y":0,"z":0},"ColorDiffuse":{"r":0.713235259,"g":0.713235259,"b":0.713235259},"LayoutGroupSortIndex":0,"Value":0,"Locked":false,"Grid":true,"Snap":true,"IgnoreFoW":false,"MeasureMovement":false,"DragSelectable":true,"Autoraise":true,"Sticky":true,"Tooltip":true,"GridProjection":false,"HideWhenFaceDown":true,"Hands":true,"CardID":279415,"SidewaysCard":false,"CustomDeck":{"2794":{"FaceURL":"https://i.imgur.com/uUbvwIp.jpg","BackURL":"http://cloud-3.steamusercontent.com/ugc/931552806915249927/583EE2570FC1A094D59B991E97AB542CA94BEBC9/","NumWidth":10,"NumHeight":7,"BackIsHidden":true,"UniqueBack":false,"Type":0}},"LuaScript":"","LuaScriptState":"","XmlUI":""}]}